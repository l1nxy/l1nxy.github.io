<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Raft | linxy's blog</title>
<meta name=keywords content><meta name=description content="linxy's blog"><meta name=author content="linxy"><link rel=canonical href=https://linxy.dev/tags/raft/><link crossorigin=anonymous href=/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as=style><link rel=icon href=https://linxy.dev/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://linxy.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://linxy.dev/favicon-32x32.png><link rel=apple-touch-icon href=https://linxy.dev/apple-touch-icon.png><link rel=mask-icon href=https://linxy.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://linxy.dev/tags/raft/index.xml><link rel=alternate hreflang=en href=https://linxy.dev/tags/raft/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://linxy.dev/tags/raft/"><meta property="og:site_name" content="linxy's blog"><meta property="og:title" content="Raft"><meta property="og:description" content="linxy's blog"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://linxy.dev/images/papermod-cover.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://linxy.dev/images/papermod-cover.png"><meta name=twitter:title content="Raft"><meta name=twitter:description content="linxy's blog"></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://linxy.dev/ accesskey=h title="linxy's blog (Alt + H)">linxy's blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://linxy.dev/fr/ title=French aria-label=:fr:>ğŸ‡«ğŸ‡·</a></li><li><a href=https://linxy.dev/fa/ title=Fa aria-label=Fa>Fa</a></li></ul></div></div><ul id=menu><li><a href=https://linxy.dev/archives title=Archive><span>Archive</span></a></li><li><a href=https://linxy.dev/search/ title=Search><span>Search</span></a></li><li><a href=https://linxy.dev/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://linxy.dev/>Home</a>&nbsp;Â»&nbsp;<a href=https://linxy.dev/tags/>Tags</a></div><h1>Raft
<a href=/tags/raft/index.xml title=RSS aria-label=RSS><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" height="23"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></h1></header><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>raft extentedè®ºæ–‡ç¬”è®°</h2></header><div class=entry-content><p>raftåŸºç¡€ ä¸€ä¸ªrafté›†ç¾¤ä¸€èˆ¬æ¥è¯´æœ‰5ä¸ªæœåŠ¡å™¨ç»“ç‚¹ï¼Œèƒ½è®©ç³»ç»Ÿæ‰¿å—å…¶ä¸­ä»»æ„ä¸¤å°çš„downæ‰ã€‚æ¯ä¸ªæœåŠ¡å™¨ä¸€å…±æœ‰ä¸‰ä¸ªçŠ¶æ€ï¼Œleader,follower,candidate,followerè¢«åŠ¨çš„æ¥å—æ¥è‡ªcandidateä¸leaderçš„æ¶ˆæ¯å¹¶ä½œå‡ºå›åº”ã€‚leader handleäº†æ‰€æœ‰äº†æ‰€æœ‰çš„å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå¦‚æœfolloweræ¥æ”¶åˆ°äº†è¯·æ±‚ï¼Œä¼šé‡å®šå‘åˆ°leaderé‚£å»ã€‚
raftæŠŠæ—¶é—´åˆ†æˆä»»æ„é•¿çš„é˜¶æ®µï¼Œä»é€‰ä¸¾å¼€å§‹ï¼Œæ¯ä¸ªé˜¶æ®µéƒ½æ˜¯ä¸€ä¸ªè¿ç»­å¢é•¿çš„æ•´æ•°ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªcandidateä¼šå°è¯•æˆä¸ºleaderã€‚å¦‚æœæœ‰ä¸€ä¸ªcandidateæˆä¸ºäº†leaderï¼Œåˆ™æ¥ä¸‹æ¥çš„termï¼Œå®ƒå°†æ˜¯leaderã€‚åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œé€‰ä¸¾ä¼šå‡ºç°ï¼Œå¹³åˆ†ç¥¨æ•°çš„æƒ…å†µï¼Œè¿™ç§æƒ…å†µï¼Œtermå°†ä¼šç»´æŒæ²¡æœ‰leaderçš„çŠ¶æ€åˆ°ç»“æŸï¼Œåˆ°ä¸‹ä¸€æ¬¡çš„æ–°çš„é€‰ä¸¾ã€‚
ä¸åŒçš„æœåŠ¡å™¨ å¯èƒ½æ„ŸçŸ¥ä¸åˆ°ä¸åŒçš„termä¹‹é—´çš„è½¬æ¢ï¼Œæˆ–è€…æ ¹æœ¬ä¸çŸ¥é“æœ‰é€‰ä¸¾è¿™å›äº‹ï¼Œåœ¨è¿™å…¶ä¸­ï¼Œtermå……å½“äº†ä¸€ä¸ªé€»è¾‘æ—¶é’Ÿçš„ä½œç”¨ï¼Œèƒ½è®©æœåŠ¡å™¨èƒ½æ£€æµ‹è¿‡æ—¶çš„ä¿¡æ¯ï¼Œæ¯”å¦‚è½åçš„leaderã€‚æ¯ä¸€ä¸ªæœåŠ¡å™¨æœ‰ä¸€ä¸ªcurrent term numberï¼Œéšç€æ—¶é—´å¢é•¿ï¼Œå½“æœåŠ¡å™¨ä¹‹é—´é€šä¿¡æ—¶ï¼Œcurrent term ä¼šè¢« äº¤æ¢ï¼Œå¦‚æœæœ‰ä¸€ä¸ªæœåŠ¡å™¨çš„termå°äºåˆ«çš„ï¼Œå°±ä¼šæ›´æ–°è‡ªå·±çš„ï¼Œå¦‚æœä¸€ä¸ªcanditateæˆ–è€…leaderå‘ç°å®ƒè‡ªå·±çš„termè¿‡æ—¶äº†ï¼Œå°±ä¼šé©¬ä¸Šè½¬å˜æˆfollowerï¼Œå¦‚æœæœåŠ¡å™¨æ”¶åˆ°äº†ä¸€ä¸ªè¿‡æ—¶çš„è¯·æ±‚ï¼Œåˆ™ä¼šç›´æ¥æ‹’ç»è¿™ä¸ªè¯·æ±‚ã€‚
raftçš„æœåŠ¡å™¨ä¹‹é—´ç”¨rpcè¯·è¡Œé€šä¿¡ï¼Œå…¶ä¸­RequestVoteç”¨äºcanditate æ¥è¿›è¡Œé€‰ä¸¾ï¼ŒAppendEntries ç”¨äºåˆ†å‘logä¸å½“å¿ƒè·³åŒ…ï¼ˆäº‹å®ä¸Šæ˜¯æ— è®ºæ”¶åˆ°ä¸€ä¸ªè¯·æ±‚ï¼Œéƒ½åº”è¯¥é‡ç½®time out chekcerï¼‰ã€‚å¦å¤– è¿˜æœ‰ä¸€ä¸ªè½¬ç§»å¿«ç…§çš„rpcã€‚ä¹‹å å†è¯´ã€‚
é€‰ä¸¾ raftä½¿ç”¨å¿ƒè·³æœºåˆ¶æ¥è§¦å‘é€‰ä¸¾ã€‚å½“æœåŠ¡å™¨å¯åŠ¨çš„æ—¶å€™ï¼Œå®ƒä»¬éƒ½æ˜¯followerï¼Œfolloweråœ¨æ”¶åˆ°æ¥è‡ªleaderæˆ–è€… candidateåˆæ³•çš„rpcè¯·æ±‚ä¹‹å‰ï¼Œä¸€ç›´æ˜¯followerï¼Œleaderä¼šå‘¨æœŸæ€§çš„å‘é€å¿ƒè·³åŒ…æ¥ä¿æŒleaderçš„æƒå¨æ€§ï¼Œå¿ƒè·³åŒ…æ˜¯ä¸€ä¸ªç©ºçš„AppendEntriesï¼Œä¸å¸¦æœ‰Log entriesã€‚å½“ä¸€ä¸ªfollowerä¸€ä¸ªelection timeoutåæ²¡æœ‰æ”¶åˆ°å¿ƒè·³åŒ…ï¼Œåˆ™è®¤ä¸ºleaderæ²¡äº†ï¼Œå°†å¼€å§‹ä¸€è½®é€‰ä¸¾ï¼Œé€‰å‡ºä¸€ä¸ªæ–°çš„leaderã€‚
ä¸ºäº†å¼€å§‹ä¸€æ¬¡é€‰ä¸¾ï¼Œfollowerä¼šç»™current term+1ç„¶åè½¬å˜æˆcandidateï¼Œç„¶åæŠ•è‡ªå·±ä¸€ç¥¨ï¼Œç„¶ååŒæ—¶å‘èµ·RequestVote RPCç»™åˆ«çš„æœåŠ¡å™¨ã€‚ä¸€ä¸ªcandidateä¼šæŒç»­åˆ°ä»¥ä¸‹ä¸‰ä»¶æƒ…å†µå‡ºç°ï¼Œ(a)å®ƒæˆäº†leaderï¼Œ(b)å…¶å®ƒæœåŠ¡å™¨æˆäº†leader(c)ä¸€æ®µæ—¶é—´è¿‡å»åï¼Œæ²¡æœ‰serveræˆä¸ºleaderã€‚è¿™å°†åœ¨ä¹‹åè®¨è®ºï¼ˆåº”è¯¥æ˜¯è¿‡ä¸€æ®µæ—¶é—´é‡æ–°å‘èµ·ï¼‰
ä¸€ä¸ªcandidateå¦‚æœæ”¶åˆ°äº†æ•´ä¸ªé›†ç¾¤ä¸­å¤§å¤šæ•°çš„æŠ•ç¥¨ (with same term)ï¼Œå°±ä¼šæˆä¸ºleaderã€‚æ¯ä¸€ä¸ªæœåŠ¡å™¨æœ€å¤šåªèƒ½æŠ•å‡ºä¸€ç¥¨ã€‚è¿™ä¸ªå¤§å¤šæ•° çš„è§„åˆ™å†³å®šäº†ï¼Œåœ¨ä¸€ä¸ªtermé‡Œï¼Œåªèƒ½ä¸€ä¸ªcandidateæˆä¸ºleaderã€‚ä¸€æ—¦candidateæˆä¸ºäº†leaderï¼Œåˆ™ä¼šå¼€å§‹å‘é€å¿ƒè·³åŒ…ç»™å…¶å®ƒæ‰€æœ‰çš„æœåŠ¡å™¨ï¼Œæ¥ä¿è¯è‡ªå·±çš„æƒå¨ä¸é˜»æ­¢å…¶å®ƒæœåŠ¡å™¨å‘èµ·é€‰ä¸¾ã€‚
åœ¨æŠ•ç¥¨çš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ ä¼šæ”¶åˆ°æ¥å…¶å®ƒæœåŠ¡å™¨å‘æ¥çš„AppendEntries RPCæ¥å£°ç§°è‡ªå·±æ˜¯leaderï¼Œè¿™ç§æƒ…å†µï¼Œçœ‹leaderçš„termä¸è‡ªå·±çš„current termçš„å¤§å°ï¼Œå¦‚æœæ¯”è‡ªå·±å¤§ï¼Œé‚£åˆ«äººå°±æ˜¯leaderï¼Œè‡ªå·±å°†é€€å›åˆ°followerçš„çŠ¶æ€ï¼Œå¦‚æœæ¯”è‡ªå·±å°ï¼Œå°±æ˜¯æ‹’ç»åˆ«äººçš„RPC callï¼Œå¹¶ç»§ç»­è¿›è¡Œé€‰ä¸¾ã€‚
ä¸€ä¸ªé€‰ä¸¾å¦‚æœé€‰ä¸å‡ºä¸€ä¸ªleaderé‚£å°±æ˜¯åˆ†è£‚çš„é€‰ä¸¾ï¼Œå³æ²¡äººå¾—åˆ°å¤§å¤šæ•°ç¥¨ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œä¼šç­‰å¾…è¶…æ—¶ç›´åˆ°ä¸‹ä¸€æ¬¡çš„é€‰ä¸¾ï¼Œä½†æ˜¯å¦‚æœ æ²¡æœ‰åšé¢å¤–çš„æ“ä½œï¼Œåˆ†è£‚çš„é€‰ä¸¾ä¼šä¸åœçš„è¿›è¡Œä¸‹å»ã€‚
rafté‡‡ç”¨äº†éšæœºçš„é€‰ä¸¾è¶…æ—¶æ¥ä¿è¯split voteæ˜¯å¾ˆå°‘è§çš„å¹¶ä¸”èƒ½å¿«é€Ÿçš„è¢«è§£å†³ã€‚å³æ¯ä¸€ä¸ªæœåŠ¡å™¨çš„election timeoutä¸ä¸€æ ·ï¼Œåœ¨é‡æ–°å‘èµ·é€‰ä¸¾çš„ä¹‹å‰ä¼šç­‰å¾…è¿™ä¸ªtimeoutï¼Œtimeoutå°‘çš„ä¼šå…ˆå‘èµ·é€‰ä¸¾ã€‚ä¸€èˆ¬çš„timeoutä¼šé€‰æ‹©ä¸€ä¸ªåŒºé—´æ¯”å¦‚150-300msä¹‹é—´ã€‚è¿™æ ·ä¼šæœ‰ä¸€ä¸ªæœåŠ¡å™¨è¶…æ—¶å®Œæˆå¹¶åœ¨åˆ«çš„æœåŠ¡å™¨èŠ‚ç‚¹è¶…æ—¶å®Œæˆå‰å®Œæˆé€‰ä¸¾ã€‚
Log replication ä¸€æ—¦ä¸€ä¸ªleaderè¢«é€‰ä¸¾ï¼Œé‚£å®ƒå°±å¼€å§‹æ¥å—clientçš„è¯·æ±‚ï¼Œæ¯ä¸€ä¸ªclientçš„è¯·æ±‚éƒ½åŒ…å«ä¸€ä¸ªå‘½ä»¤ï¼Œè¿™ä¸ªå‘½ä»¤ä¼šè¢« replicated state machinesæ‰§è¡Œï¼Œleaderå°†ä¼šæŠŠè¿™ä¸ªcommand appendåˆ°æ—¥å¿—ä¸­å»ï¼Œä½œä¸ºä¸€ä¸ªæ–°çš„entryï¼Œç„¶åç”¨AppendEntries åˆ†å‘åˆ°å…¶å®ƒçš„æœåŠ¡å™¨ã€‚ leaderä¼šæ°¸è¿œçš„å°è¯•å»å†™å…¥follower log entryï¼Œç›´åˆ°æ‰€æœ‰çš„log entryéƒ½è¢« å†™å…¥ã€‚
leaderå†³å®šä»€ä¹ˆæ—¶å€™æ—¥å¿—è¢« commitï¼Œå½“å¤§å¤šæ•°çš„æœåŠ¡å™¨éƒ½å¤åˆ¶äº†ä¸€ä»½entryåï¼Œå°±ä¼šæäº¤ï¼Œä¹Ÿä¼šæå‰ä¹‹å‰çš„entriesï¼Œè®ºæ–‡ä¸­è®¾è®¡äº†ä¸¤ä¸ªé‡è¦çš„å±æ€§
å¦‚æœä¸åŒæ—¥å¿—ä¸­çš„ä¸¤ä¸ªEntryæœ‰ä¸€æ ·çš„indexè·Ÿtermï¼Œé‚£ä»–ä»¬å­˜çš„ä¸€ä¸ªä¸œè¥¿ å¦‚æœä¸åŒæ—¥å¿—ä¸­çš„ä¸¤ä¸ªentryæœ‰ä¸€æ ·çš„indexè·Ÿtermï¼Œé‚£ä»–ä»¬ä¹‹å‰çš„æ‰€æœ‰entryæ˜¯ç›¸åŒçš„ã€‚ å±æ€§1ä¿è¯äº†ï¼Œåœ¨ç»™å®šçš„termä¸indexä¸­åªä¼šåˆ›å»ºä¸€ä¸ªentryï¼Œå±æ€§2ä¿è¯äº†ä¸€è‡´æ€§çš„ç®€å•æ€§ã€‚
å¦‚æœfollowerå‘ç°leaderå‘è¿‡æ¥çš„indexè·Ÿtermåœ¨è‡ªå·±çš„logé‡Œæ²¡æœ‰ï¼Œé‚£ä¹ˆä¼šæ‹’ç»è¿™ä¸ªæ–°çš„entryã€‚ï¼ˆå› ä¸ºåœ¨æ¶ˆæ¯ä¸­åŒ…å«äº†è¿™æ¡æ–°çš„ä¹‹å‰çš„indexè·Ÿtermï¼Œæ‰€ä»¥å¯ä»¥æ£€æµ‹ä¹‹å‰çš„ä¸€è‡´æ€§ï¼Œå¦‚æœä¹‹å‰çš„éƒ½ä¸ä¸€è‡´å°±æ ¹æœ¬ä¸ä¼šappendè¿™ä¸ªæ–°çš„ï¼‰
åœ¨Raftä¸­ï¼Œå¤„ç†leaderä¸followerçš„ä¸ä¸€è‡´æ€§æ˜¯é€šè¿‡å¼ºåˆ¶æŠŠleaderçš„logè®°å½•å¤åˆ¶ç»™followeræ¥å®Œæˆçš„ï¼Œè¿™æ„å‘³ç€followerçš„logçš„å†²çªéƒ¨åˆ†ï¼Œä¼šè¢«å®Œå…¨è¦†ç›–ã€‚
ä¸ºäº†ä½¿follwerçš„logä¿æŒä¸€è‡´ï¼Œleaderå¿…é¡»æ‰¾åˆ°leaderä¸follweræœ€è¿‘çš„ä¸€ä¸ªä¸€æ ·çš„entryï¼Œç„¶åæŠŠè¿™ä¸ªä¹‹åçš„logéƒ½å‘ç»™followerã€‚
leaderå¯¹äºæ¯ä¸€ä¸ªfolloweréƒ½ç»´æŠ¤äº†ä¸€ä¸ªindexï¼Œè¿™ä¸ªindexæ˜¯leaderå°†è¦å‘ç»™followerçš„ä¸‹ä¸€ä¸ªindexï¼Œå½“ä¸€ä¸ªleaderä¸Šå°åï¼Œ ä¼šæŠŠè¿™ä¸ªnext indexåˆå§‹åŒ–ä¸ºè‡ªå·±logä¸­çš„æœ€åä¸€ä¸ªindexï¼Œå¦‚æœæœ‰followerçš„è®°å½•ä¸leaderä¸ä¸€è‡´ï¼Œé‚£ä¹ˆåœ¨ä¸‹ä¸€æ¬¡Append Entries RPCçš„ä¸€è‡´æ€§æ£€æŸ¥ä¸­å¤±è´¥ã€‚å½“è¿™ä¸ªè°ƒç”¨å¤±è´¥åï¼Œleaderå°†å†³å®šä¸‹ä¸€ä¸ªnext indexæ˜¯å¤šå°‘ï¼Œæœ€ç»ˆï¼Œnext indexä¼šåœ¨é‡è¯•ä¸­åˆ°è¾¾leaderä¸followerä¸€è‡´çš„åœ°æ–¹ã€‚å½“RPCè°ƒç”¨æˆåŠŸä¹‹åï¼Œleaderä¼šæŠŠä¹‹åçš„è®°å½•å…¨å‘ç»™followerï¼Œè¿™æ ·å°±followerå°±å®Œæˆäº†ä¸leaderçš„ä¸€è‡´æ€§åŒæ­¥ã€‚
...</p></div><footer class=entry-footer><span title='2020-08-30 13:34:56 +0800 +0800'>August 30, 2020</span>&nbsp;Â·&nbsp;1 min&nbsp;Â·&nbsp;linxy</footer><a class=entry-link aria-label="post link to raft extentedè®ºæ–‡ç¬”è®°" href=https://linxy.dev/posts/raft-notes/></a></article></main><footer class=footer><span>Â© <a href=https://linxy.dev>linxy&rsquo;s blog</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>